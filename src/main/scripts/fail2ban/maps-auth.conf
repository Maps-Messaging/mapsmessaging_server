[Definition]
# Match failures and lockouts emitted by MAPS auth monitor logging.
# Assumes the log line contains one of these tokens and the client IP address.
#
# Example lines this will match (examples only):
# ... AUTH_FAILURE user=bob attempts=3 ip=203.0.113.9
# ... AUTH_LOCKOUT_STARTED user=bob attempts=5 lockSeconds=60 ip=203.0.113.9
#
# If your log format is different, adjust the tail so the IP is captured as <HOST>.

failregex = ^.*\bAUTH_FAILURE\b.*\b(?P<host><HOST>)\b.*$
            ^.*\bAUTH_LOCKOUT_STARTED\b.*\b(?P<host><HOST>)\b.*$
            ^.*EndPoint closed during protocol negotiation ip=<HOST>\s*$
            ^.*Failed to detect protocol on End Point .*?, ip=<HOST>\s*$

ignoreregex = ^.*ip=127\..*$
              ^.*ip=::1.*$